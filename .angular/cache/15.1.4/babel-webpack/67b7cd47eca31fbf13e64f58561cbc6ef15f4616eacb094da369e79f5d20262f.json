{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { cardAnimation } from './../../../animations/animations';\nimport { DetailsPqrPage } from './details-pqr/details-pqr.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/auth.service\";\nimport * as i2 from \"../../../services/pqrs.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"../../../services/toast.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"../../../shared/header/header.component\";\nimport * as i8 from \"../../../pipes/avatar-img.pipe\";\nimport * as i9 from \"../../../pipes/pqrs-filter.pipe\";\nimport * as i10 from \"../../../pipes/image-url.pipe\";\nfunction PqrsPage_ion_col_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-col\", 11)(1, \"ion-card\")(2, \"ion-card-content\");\n    i0.ɵɵtext(3, \" No se encontraron registros \");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction PqrsPage_ion_col_15_img_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 21);\n    i0.ɵɵpipe(1, \"avatarImg\");\n  }\n  if (rf & 2) {\n    const pqr_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", i0.ɵɵpipeBind1(1, 1, pqr_r2.user.avatar), i0.ɵɵsanitizeUrl);\n  }\n}\nfunction PqrsPage_ion_col_15_img_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 21);\n    i0.ɵɵpipe(1, \"imageUrl\");\n  }\n  if (rf & 2) {\n    const pqr_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", i0.ɵɵpipeBind2(1, 1, pqr_r2.user.image, \"Profiles\"), i0.ɵɵsanitizeUrl);\n  }\n}\nfunction PqrsPage_ion_col_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-col\", 12)(1, \"ion-card\")(2, \"ion-fab\", 13)(3, \"ion-fab-button\", 14);\n    i0.ɵɵlistener(\"click\", function PqrsPage_ion_col_15_Template_ion_fab_button_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const pqr_r2 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.presentAlertConfirm(pqr_r2.id));\n    });\n    i0.ɵɵelement(4, \"ion-icon\", 15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-card-content\", 16);\n    i0.ɵɵlistener(\"click\", function PqrsPage_ion_col_15_Template_ion_card_content_click_5_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const pqr_r2 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.details(pqr_r2.id));\n    });\n    i0.ɵɵelementStart(6, \"ion-list\")(7, \"ion-item\", 17)(8, \"ion-avatar\", 18);\n    i0.ɵɵtemplate(9, PqrsPage_ion_col_15_img_9_Template, 2, 3, \"img\", 19);\n    i0.ɵɵtemplate(10, PqrsPage_ion_col_15_img_10_Template, 2, 4, \"img\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ion-label\")(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\")(15, \"code\")(16, \"small\");\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"date\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelement(19, \"hr\");\n    i0.ɵɵelementStart(20, \"ion-badge\", 20);\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd()()()()()()();\n  }\n  if (rf & 2) {\n    const pqr_r2 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"@cardAnimation\", undefined);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", pqr_r2.user.avatar);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", pqr_r2.user.image);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(pqr_r2.description);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(18, 7, pqr_r2.createdDate, \"short\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"color\", pqr_r2.answered ? \"success\" : \"light\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", pqr_r2.answered ? \"Respondida\" : \"Pendiente\", \" \");\n  }\n}\nexport let PqrsPage = /*#__PURE__*/(() => {\n  class PqrsPage {\n    constructor(authService, pqrsService, modalCtrl, alertCtrl, toastService) {\n      this.authService = authService;\n      this.pqrsService = pqrsService;\n      this.modalCtrl = modalCtrl;\n      this.alertCtrl = alertCtrl;\n      this.toastService = toastService;\n      this.answered = false;\n      this.pqrs = [];\n    }\n    ngOnInit() {\n      return __awaiter(this, void 0, void 0, function* () {\n        // Obtener el usuario actual\n        this.currentUser = yield this.authService.getCurrentUserAsync();\n        // Data changes del Pqrs service\n        this.pqrsService.dataChanges.subscribe(message => {\n          this.toastService.presentToast({\n            message,\n            duration: 2000\n          });\n          this.loadPqrs();\n        });\n        // Cargar pqrs\n        this.loadPqrs();\n      });\n    }\n    // Obtener el listado de pqrs del usuario actual\n    loadPqrs() {\n      this.pqrsService.getPqrsByUser(this.currentUser.id).subscribe(res => this.pqrs = res);\n    }\n    details(pqrId) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const modal = yield this.modalCtrl.create({\n          component: DetailsPqrPage,\n          componentProps: {\n            pqrId\n          }\n        });\n        return yield modal.present();\n      });\n    }\n    presentAlertConfirm(pqrId) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const alert = yield this.alertCtrl.create({\n          header: '¿Estás seguro?',\n          message: 'No podrás revertir los cambios',\n          cssClass: 'alert-buttons',\n          mode: 'ios',\n          buttons: [{\n            text: 'Cancelar',\n            role: 'cancel',\n            cssClass: 'btn-cancel',\n            handler: blah => {\n              console.log('Confirm Cancel: blah');\n            }\n          }, {\n            text: 'Eliminar',\n            cssClass: 'btn-confirm-delete',\n            handler: () => {\n              this.deletePqr(pqrId);\n            }\n          }]\n        });\n        yield alert.present();\n      });\n    }\n    presentAlertPrompt() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const alert = yield this.alertCtrl.create({\n          cssClass: 'my-custom-class',\n          header: 'Nuevo PQR',\n          inputs: [{\n            name: 'description',\n            type: 'text',\n            placeholder: 'Descripción'\n          }],\n          buttons: [{\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'btn-cancel',\n            handler: () => {\n              console.log('Confirm Cancel');\n            }\n          }, {\n            text: 'Guardar',\n            cssClass: 'btn-save',\n            handler: data => {\n              const {\n                description\n              } = data;\n              if (description) {\n                this.addPqr(description);\n              } else {\n                this.toastService.presentToast({\n                  message: 'La descripción es requerida',\n                  duration: 1000\n                });\n              }\n            }\n          }]\n        });\n        yield alert.present();\n      });\n    }\n    deletePqr(pqrId) {\n      this.pqrsService.deletePqr(pqrId).subscribe(_ => {\n        this.pqrsService.dataChanges.next('El pqr ha sido eliminado!');\n      });\n    }\n    addPqr(description) {\n      const pqr = {\n        description,\n        userId: this.currentUser.id\n      };\n      this.pqrsService.insertPqr(pqr).subscribe(_ => {\n        this.pqrsService.dataChanges.next('El pqr ha sido agregado exitosamente!');\n      });\n    }\n  }\n  PqrsPage.ɵfac = function PqrsPage_Factory(t) {\n    return new (t || PqrsPage)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.PqrsService), i0.ɵɵdirectiveInject(i3.ModalController), i0.ɵɵdirectiveInject(i3.AlertController), i0.ɵɵdirectiveInject(i4.ToastService));\n  };\n  PqrsPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PqrsPage,\n    selectors: [[\"app-pqrs\"]],\n    decls: 17,\n    vars: 10,\n    consts: [[\"title\", \"Preguntas, Quejas y Reclamos\"], [\"color\", \"light\", 1, \"ion-padding\", 3, \"fullscreen\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\"], [3, \"click\"], [\"name\", \"add\"], [\"size-md\", \"6\", \"size-sm\", \"8\", \"size-xs\", \"12\"], [\"lines\", \"none\", \"color\", \"light\"], [\"slot\", \"start\", \"color\", \"success\", 3, \"ngModel\", \"ngModelChange\"], [1, \"ion-justify-content-start\"], [\"size\", \"12\", 4, \"ngIf\"], [\"size-md\", \"4\", \"size-sm\", \"6\", \"size-xs\", \"12\", 4, \"ngFor\", \"ngForOf\"], [\"size\", \"12\"], [\"size-md\", \"4\", \"size-sm\", \"6\", \"size-xs\", \"12\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\"], [\"color\", \"danger\", \"size\", \"small\", 3, \"click\"], [\"name\", \"trash\"], [2, \"padding\", \"0px\", 3, \"click\"], [\"lines\", \"none\"], [\"slot\", \"start\"], [3, \"src\", 4, \"ngIf\"], [3, \"color\"], [3, \"src\"]],\n    template: function PqrsPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-header\", 0);\n        i0.ɵɵelementStart(1, \"ion-content\", 1)(2, \"ion-fab\", 2)(3, \"ion-fab-button\", 3);\n        i0.ɵɵlistener(\"click\", function PqrsPage_Template_ion_fab_button_click_3_listener() {\n          return ctx.presentAlertPrompt();\n        });\n        i0.ɵɵelement(4, \"ion-icon\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"ion-grid\")(6, \"ion-row\")(7, \"ion-col\", 5)(8, \"ion-item\", 6)(9, \"ion-toggle\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function PqrsPage_Template_ion_toggle_ngModelChange_9_listener($event) {\n          return ctx.answered = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"ion-label\");\n        i0.ɵɵtext(11);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(12, \"ion-row\", 8);\n        i0.ɵɵtemplate(13, PqrsPage_ion_col_13_Template, 4, 0, \"ion-col\", 9);\n        i0.ɵɵpipe(14, \"pqrsFilter\");\n        i0.ɵɵtemplate(15, PqrsPage_ion_col_15_Template, 22, 10, \"ion-col\", 10);\n        i0.ɵɵpipe(16, \"pqrsFilter\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngModel\", ctx.answered);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.answered ? \"Respondidas\" : \"Sin responder\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind2(14, 4, ctx.pqrs, ctx.answered).length === 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(16, 7, ctx.pqrs, ctx.answered));\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i6.NgControlStatus, i6.NgModel, i3.IonAvatar, i3.IonBadge, i3.IonCard, i3.IonCardContent, i3.IonCol, i3.IonContent, i3.IonFab, i3.IonFabButton, i3.IonGrid, i3.IonIcon, i3.IonItem, i3.IonLabel, i3.IonList, i3.IonRow, i3.IonToggle, i3.BooleanValueAccessor, i7.HeaderComponent, i5.DatePipe, i8.AvatarImgPipe, i9.PqrsFilterPipe, i10.ImageUrlPipe],\n    styles: [\"ion-card[_ngcontent-%COMP%]{cursor:pointer}\"],\n    data: {\n      animation: [cardAnimation]\n    }\n  });\n  return PqrsPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}